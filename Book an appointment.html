<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Book an Appointment</title>
  <link rel="stylesheet" href="Book-an-appointment.css" />
</head>
<body>
  <div class="Image">
    <img src="bg-login.png" alt="Background Image" />
  </div>

  <div class="sq-box">
    <div class="slide">
      <form id="appointmentForm" class="form">
        <span class="title">Book an Appointment</span>

        <!-- First Name -->
        <div class="input-box">
          <input type="text" class="input" name="firstName" required />
          <label class="label">First Name</label>
        </div>

        <!-- Last Name -->
        <div class="input-box">
          <input type="text" class="input" name="lastName" required />
          <label class="label">Last Name</label>
        </div>

        <!-- Email -->
        <div class="input-box">
          <input type="email" class="input" name="email" required />
          <label class="label">Email Address</label>
        </div>

        <!-- Treatment Dropdown -->
        <div class="input-box">
          <select name="treatment" id="treatment" class="select-input" required>
            <option value="" disabled selected>Select a treatment</option>
            <option value="Teeth Whitening">Teeth Whitening</option>
            <option value="Wisdom Teeth Removal">Wisdom Teeth Removal</option>
            <option value="Tooth Extraction">Tooth Extraction</option>
            <option value="Fillings & Restorations">Fillings & Restorations</option>
            <option value="Invisalign">Invisalign</option>
            <option value="Routine Cleanings & Exams">Routine Cleanings & Exams</option>
          </select>
        </div>

        <!-- Appointment time -->
        <div class="input-box">
          <input type="datetime-local" class="input" name="appointmentTime" required />
        </div>

        <!-- Submit Button -->
        <button type="submit">Book an Appointment</button>
      </form>
    </div>
  </div>
  <script>
    document.getElementById('appointmentForm').addEventListener('submit', async function (e) {
      e.preventDefault(); // Prevent regular form submission
  
      const form = e.target;
  
      const data = {
        firstName: form.firstName.value,
        lastName: form.lastName.value,
        email: form.email.value,
        treatment: form.treatment.value,
        appointmentTime: form.appointmentTime.value
      };
  
      try {
        const response = await fetch('/submit-appointment', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });
  
        const result = await response.json();
  
        if (result.success) {
          alert('✅ Appointment saved successfully!');
          form.reset(); // optional: clear the form
        } else {
          alert('❌ Failed to save appointment: ' + result.message);
        }
      } catch (error) {
        alert('❌ An error occurred while submitting.');
        console.error('Submission error:', error);
      }
    });
  </script>

</body>
</html>
