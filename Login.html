<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="Login.css">
    <title>Sign In</title>
</head>

<body>
    <!-- Section for the login image -->
    <div class="Image">
        <img src="bg-login.png" alt="Login Background">
    </div>

    <!-- Container for the login form -->
    <div class="sq-box">
        <input type="checkbox" id="toggle">
        
        <!-- Sliding panel for form display -->
        <div class="slide">
            <form class="form" id="loginForm">
                <span class="title">WELCOME BACK</span>

                <!-- Email input -->
                <div class="input-box">
                    <input type="email" class="input" id="regUsername" required>
                    <label class="label">Email Address</label>
                </div>

                <!-- Password input -->
                <div class="input-box">
                    <input type="password" class="input" id="log2Password" required>
                    <label class="label">Password</label>
                    <!-- Optional password toggle icons -->
                    <span onclick="myLogPassword()">
                        <i id="eye-2">üëÅÔ∏è</i>
                        <i id="eye-slash-2" style="display:none;">üôà</i>
                    </span>
                </div>

                <!-- Login button -->
                <button type="submit">LOG IN</button>
                
                <!-- Error label -->
                <p id="lblMessage" style="color: red;"></p>
            </form>
        </div>
    </div>

    <script>
        // Password toggle
        function myLogPassword() {
            const pwd = document.getElementById('log2Password');
            const eye = document.getElementById('eye-2');
            const eyeSlash = document.getElementById('eye-slash-2');
            if (pwd.type === 'password') {
                pwd.type = 'text';
                eye.style.display = 'none';
                eyeSlash.style.display = 'inline';
            } else {
                pwd.type = 'password';
                eye.style.display = 'inline';
                eyeSlash.style.display = 'none';
            }
        }

        window.onload = function () {
            const eye = document.getElementById('eye-2');
            const eyeSlash = document.getElementById('eye-slash-2');
            if (eye && eyeSlash) {
                eye.style.display = 'inline';
                eyeSlash.style.display = 'none';
            }
        };

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const formData = {
                email: document.getElementById('regUsername').value,
                password: document.getElementById('log2Password').value,
            };

            const res = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData)
            });

            const result = await res.json();
            if (result.success) {
                window.location.href = '/Staff-Dashboard.html';
            } else {
                document.getElementById('lblMessage').textContent = result.message;
            }
        });
    </script>
</body>
</html>
